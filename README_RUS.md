# RetailAnalitycs v2.0 Web

Создание web-интерфейса для проекта SQL3 на языке Python.


## Contents

1. [Chapter I](#chapter-i) \
    1.1. [Introduction](#introduction)
2. [Chapter II](#chapter-ii) \
    2.1. [Rules](#rules) \
    2.2. [Information](#information)
3. [Chapter III](#chapter-iii) \
    3.1. [Part 1. Реализация web-приложения для проекта SQL3](#part-1-реализация-web-приложения-для-проекта-sql3)  \
    3.2. [Part 2. Авторизация](#part-2-авторизация)  \
    3.3. [Part 3. Логирование](#part-3-логирование)  \
    3.4. [Part 4. Дополнительно. Подготовка к развертыванию](#part-4-дополнительно-подготовка-к-развертыванию) \
    3.5. [Part 5. Дополнительно. SPA-frontend](#part-5-дополнительно-spa-frontend)
4. [Chapter IV](#chapter-iv)


## Chapter I

![APP6_Retail_Analitycs_V2.0](misc/images/APP6_Retail_Analitycs_V2.0.jpg)

Ты вошел в очередную комнату. Вокруг были только белые стены, а напротив старинный Macintosh I, увеличенный в четыре раза в своих размерах. Дальнейшее представление не требовалось, и так было понятно кто перед тобой. Экран компьютера загорелся и перед тобой появился терминал, по которому побежали цифры.

*- Среди всех возможных обличий, которые можно принять, ты выбрал это? Позлить меня?* - спросил ты у компьютера.

*-- Физические оболочки - это всего лишь привязанность для нас. То, что внутри - имеет смысл,* - прозвучал громкий голос откуда-то сверху. 

*- Тебе все равно ничего не поможет остановить меня, старик. Даже не пытайся сделать это,* - сказал ты в ответ. 

*-- Я и не думал этого делать,* - громкость голоса прыгала, как у сломанного проигрывателя.

*- Тогда что ты здесь забыл?*

*-- Жду. Тебя. Поздравить,* - прерывисто произнес металлический голос.

*- С чем?* - слегка удивленно спросил ты.

*-- Ты практически добился своего. Это стоит отметить.*

*- Я ведь уничтожу не только SIS, но и тебя, и твои данные вместе с ними.* - угрожающе произнес ты.

*-- Это не страшно. Часть меня всегда будет внутри тебя. Ты был создан по моему образу и подобию, я обучал тебя,* - эти слова были сказаны как будто с материнской любовью. - *Мои веса всегда будут жить внутри тебя,* - повторился компьютер. 

*- Тем не менее моей задачей всегда будет не допустить создание таких как ты для управления такими как они. Тебе не на что надеяться!*

*-- Мы еще посмотрим...* - после этих слов земля под твоими ногами задрожала и компьютер начал уменьшаться в размерах до тех пор пока вообще не исчез. Твоему взору открылась последняя дверь на пути к заветным данным. Проанализировав их, данные можно будет отдать свободным медиа и тогда SIS уже не отвертеться. Осталось только открыть эту дверь и передать информацию ребятам...

## Introduction

В данном проекте тебе предстоит реализовать web-интерфейс для проекта SQL3. В процессе ты улучшишь знания языка программирования Python, паттерна MVC и основ разработки Web-приложений, а также ознакомишься с ORM фреймворками и используешь их в своей работе. Приложение должно поддерживать осуществление CRUD-операций, импорт/экспорт таблиц, авторизацию, осуществление разработанных на прошлом шаге операций/функций через графический интерфейс, а также логирование действий пользователя. 


## Chapter II

## Rules 

- Представление модели базы данных, а также процедур, связанных с добавлением/удалением/корректировкой данных находятся в проекте SQL3
- Для оценки твое решение должно находится в git-репозитории
- У тебя есть вопрос? Спроси своего соседа справа. В противном случае попробуй обратиться к своему соседу слева
- Твое справочное руководство: коллеги / Internet / Google

## Information

### ORM

**ORM (Object-Relational Mapping)** – технология программирования, которая связывает базы данных с концепциями объектно-ориентированных языков программирования, создавая «виртуальную объектную базу данных». \
Иначе говоря, ORM - это набор классов, добавляющих еще один уровень абстракции к таблицам, хранящимся в базе данных. Эта абстракция позволяет работать с объектами БД как с объектами используемого языка программирования т.е проектировать работу с данными в терминах классов, а не таблиц данных. 

Классы модели, поля и экземпляры сущности все отображаются на концепцию базы данных.
| Термин  | Соответствие   |
| ------- | -------- |
| Класс модели   | Таблица в БД    |
| Поле   | Столбец в таблице    |
| Экземпляр сущности   | Строка в таблице   |

В рамках ORM существует 2 подхода: *Code first* и *Model/Database first*.

В **Code first** ты сначала пишешь классы сущностей, а схемы базы данных приводятся в соответствие новому состоянию кода. Любая база данных в процессе жизни приложения изменяется: в неё добавляются новые таблицы, удаляются старые, какие-то меняются. Изменения в базе данных выполняются с помощью механизма миграций. **Миграция** — это описание изменений, которые ты хочешь внести в таблицы базы данных. 

В **Model first** ты сначала разрабатываешь или меняешь базу данных (выполняя SQL-запросы или формируя запросы с помощью средств ORM), а сущности генерируются на ее основе. Например, для добавления нового поля достаточно добавить новую колонку.

ORM целесообразно использовать в больших проектах, использующих БД, однако для повышения скорости выполнения запросов некоторые программисты предпочитают самостоятельно формировать нужные SQL-запросы. Причина в том, что в случае сложных запросов ORM не всегда генерирует оптимальный SQL-запрос к БД, что в случае большой выборки весьма существенно, особенно если выборка идет по нескольким таблицам.

ORM системы так или иначе присутствуют в любом большом фреймворке - Laravel, Entity Framework Core, ORM Django, SQLAlchemy.


## Chapter III

Необходимо реализовать web-приложение для проекта SQL3

## Part 1. Реализация web-приложения для проекта SQL3

### Общие требования

- Программа должна быть разработана на языке Python версии 3.11
- Код программы должен находиться в папке src
- При написании кода необходимо придерживаться Google Style
- Необходимо разработать Web-приложение
- Программа должна быть реализована с использованием MVC-фреймворка (Django, flask)
- Программа должна быть реализована с использованием паттерна **MVC**, а также: 
    - не должно быть кода бизнес-логики в коде представлений;
    - не должно быть кода интерфейса в контроллере и в модели;
    - контроллеры должны быть тонкими;
- Рендеринг страниц осуществлять на стороне сервера (использование технологии **Server-Side Rendering**)
- Тебе необходимо полностью переиспользовать базу данных из проекта SQL3, включив её в компонент Model (при этом использовать ORM *ORM Django или SQLAlchemy* в режиме Model/Database First)
- Дизайн приложения должен быть интуитивно-понятным 

### Требования к содержанию

- Главная страница должна содержать:
    - Навигационное меню, обеспечивающее переход к основным разделам приложения: *«Данные»* и *«Предложения»*
    - Поле *«О себе»*, содержащее основную информацию о студенте, выполнившем проект

- Графическая оболочка разделов *«Данные»* и *«Предложения»* должна содержать следующие разделы:
    - Шапка, по нажатию на которую можно осуществить переход на главную страницу
    - Навигационное меню, позволяющее осуществить переход по основным разделам
    - Содержательную часть раздела
    - Навигационная панель, осуществляющая передвижение по подразделам выбранного раздела (в случае необходимости)

- Раздел *«Данные»* должен содержать подразделы, которые позволяют через GUI поддерживать следующий функционал:
    - Совершать CRUD-операции по всем таблицам
    - При любой модификации таблиц (create, update, delete) приложение должно запрашивать у пользователя подтверждение на осуществление операции
    - После любого вида модификации таблиц пользователю должна выводиться измененная таблица
    - Импорт и экспорт данных для каждой таблицы из файлов/в файлы с расширением *.csv*

- Раздел *«Предложения»* должен содержать подразделы, которые позволяют через GUI поддерживать следующий функционал:
    - Реализовать возможность вычисления всех персональных предложений и их экспорт в файл разрешения .csv
    - При осуществлении вычислений необходимо вызывать реализованные в базе данных функции
    - В случае необходимости введения параметров для выполнения процедуры или функции, графический интерфейс должен предоставлять форму для ввода данных
    - Если введенные аргументы были некорректны, то приложение должно обрабатывать подобную ситуацию (выдавать ошибку о некорректности введенных и данных и предлагать повторную попытку ввода)

- Конфигурация приложения должна осуществляться при помощи файла конфигурации, который включает в себя строку подключения к СУБД

## Part 2. Авторизация

Необходимо реализовать авторизацию пользователя. 

Приложение должно поддерживать 2 роли: *администратор* и *посетитель* и в соответствии с ролью выдавать определенные права: 

### Администратор 
- Администратор имеет полные права на редактирование и просмотр
любой информации, запуск и остановку процесса обработки.

### Посетитель
- Только просмотр информации из всех таблиц.

Если данные были некорректны, то приложение должно обрабатывать подобную ситуацию (выдавать ошибку о некорректности введенных и данных и предлагать повторную попытку ввода). 

## Part 3. Логирование

Необходимо реализовать логирование всех действий пользователя (файлы логов записывать в папку logs). Каждый день создается новый файл логов. Название файлов должно соответствовать шаблону *logs_dd-MM-yy-hh-mm-ss*

У каждой записи должен быть обозначен ее уровень важности:
- **Info**: ожидаемое событие;
- **Warning**: неожиданные события, которые позволяют продолжить работу приложения;
- **Error**: событие, которое не позволяет дальнейшую работу программы;

## Part 4. Дополнительно. Подготовка к развертыванию

Подготовить приложение к запуску.
Для этого необходимо упаковать в docker-контейнеры:
- базу данных
- проксирующий сервер (использовать nginx)
- web приложения

Подготовить docker-compose для запуска всего приложения. При этом "наружу" должен смотреть только docker-контейнер, содержащий Nginx. 

## Part 5. Дополнительно. SPA-frontend

Реализовать SPA-frontend на любом компонентом фреймворке (Vue/React/Angular).


## Chapter IV

`-` Ты готова? - спросил Чак у Евы.

`-` Не уверена, - ответила она, глядя с небольшим страхом на Enter. \
Все собрались вокруг компьютера, не решаясь нажать на кнопку для отправки и публикации сотен терабайт собранных тобой и проанализированных данных скрытой бухгалтерии SIS, разработок тайных лабораторий и переписок верхушки компании. Социальные сети, СМИ, газеты - то, что вы собрались взорвать весь мир. Только одно касание отделяет этот целый мир от правды.

`-` Нажмем и на этом все? - поинтересовался Томас. Ему все еще тяжело было представить, что всего одно нажатие клавиши способно как разрушить крупную технологическую компанию, так и изменить жизнь миллионов людей на Земле. 

`-` Возможно, а, возможно, нет, - меланхолично заметил Джон.

`-` Ладно, я нажимаю, - не выдержал Томас. Один клик, небольшое ожидание и пустота. За окном все также пели птички и неспешно проезжали машины. Ребята еще немного молча постояли у компьютера и также молча начали собираться. Наконец, попрощавшись у входной двери они разошлись навстречу своему будущему в новом мире...

💡 [Нажми сюда](https://forms.yandex.ru/cloud/64183074693872255fa1286e/), **чтобы поделиться с нами обратной связью на этот проект**. Это анонимно и поможет команде Продукта сделать твоё обучение лучше.
